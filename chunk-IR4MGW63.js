import{Q as r,V as n,gc as a}from"./chunk-R6KUZMSD.js";var c="app.wishlist.",o="app.guestId",d=class s{auth=n(a);uid(){let t=this.auth.currentUser();if(t?.id)return String(t.id);let e=sessionStorage.getItem(o);return e||(e=crypto.randomUUID(),sessionStorage.setItem(o,e)),`guest-${e}`}key(){return c+this.uid()}read(){try{return JSON.parse(localStorage.getItem(this.key())||"[]")}catch{return[]}}write(t){localStorage.setItem(this.key(),JSON.stringify(t)),window.dispatchEvent(new Event("wishlistUpdated")),window.dispatchEvent(new CustomEvent("wishlistCountUpdated",{detail:{count:t.length}}))}list(){return this.read()}isFavorite(t){return this.read().some(e=>e.id===t)}add(t){let e=this.read();if(!e.some(i=>i.id===t.id)){let i=[t,...e];this.write(i),window.dispatchEvent(new CustomEvent("wishlistDelta",{detail:{delta:1}}))}}remove(t){let e=this.read();if(e.some(i=>i.id===t)){let i=e.filter(h=>h.id!==t);this.write(i),window.dispatchEvent(new CustomEvent("wishlistDelta",{detail:{delta:-1}}))}}toggle(t){this.isFavorite(t.id)?this.remove(t.id):this.add(t)}clearAll(){let t=this.read().length;this.write([]),t&&window.dispatchEvent(new CustomEvent("wishlistDelta",{detail:{delta:-t}}))}static \u0275fac=function(e){return new(e||s)};static \u0275prov=r({token:s,factory:s.\u0275fac,providedIn:"root"})};export{d as a};
