import{i as _,j as E,m as R}from"./chunk-IW6AFLJC.js";import{a as q,b as C,c as d,d as I,e as M,h as T,j as k,k as L,l as A,q as F,s as P}from"./chunk-PI5CFJYO.js";import{Ma as v,Na as S,Qa as u,R as b,V as f,Xa as m,Ya as r,Yb as x,Za as i,_a as s,bc as g,cb as c,db as y,gc as N,mb as h,nb as n,ob as w,xa as l}from"./chunk-R6KUZMSD.js";function Z(t,o){t&1&&(r(0,"small",16),n(1,"Email invalide"),i())}function H(t,o){t&1&&(r(0,"small",16),n(1,"Requis"),i())}function K(t,o){if(t&1&&(r(0,"p",16),n(1),i()),t&2){let a=y();l(),w(a.error)}}function Q(t,o){t&1&&(r(0,"span"),n(1,"Se connecter"),i())}function W(t,o){t&1&&(r(0,"span"),n(1,"Connexion\u2026"),i())}var G=class t{fb=f(F);auth=f(N);router=f(_);error="";loading=!1;showPassword=!1;form=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required]],remember:[!1]});get f(){return this.form.controls}ngOnInit(){let o=localStorage.getItem("remember.login");if(o){let{email:a,password:e}=JSON.parse(o);this.form.patchValue({email:a,password:e,remember:!0})}}togglePassword(){this.showPassword=!this.showPassword}submit(){if(this.error="",this.form.invalid){this.form.markAllAsTouched();return}let{email:o,password:a,remember:e}=this.form.value;this.loading=!0;try{this.auth.login(o,a),e?localStorage.setItem("remember.login",JSON.stringify({email:o,password:a})):localStorage.removeItem("remember.login"),this.router.navigateByUrl("/")}catch(p){this.error=p?.message==="BAD_CREDENTIALS"?"Email ou mot de passe incorrect.":"Compte introuvable."}finally{this.loading=!1}}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=v({type:t,selectors:[["app-signin"]],decls:28,vars:10,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-blue-50","via-white","to-blue-100","p-6"],[1,"bg-white","rounded-2xl","shadow-xl","p-8","w-full","max-w-md"],[1,"text-2xl","font-bold","mb-6"],["autocomplete","on",1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","font-medium","mb-1"],["type","email","formControlName","email","autocomplete","username",1,"w-full","border","rounded","px-3","py-2"],["class","text-red-600",4,"ngIf"],[1,"relative"],["formControlName","password","autocomplete","current-password",1,"w-full","border","rounded","px-3","py-2","pr-10",3,"type"],["type","button","tabindex","-1",1,"absolute","right-3","top-8","text-gray-500","hover:text-blue-600",3,"click"],[1,"flex","items-center","gap-2","text-sm","text-gray-600"],["type","checkbox","formControlName","remember",1,"h-4","w-4","rounded","border-gray-300"],[1,"w-full","bg-blue-600","text-white","rounded","px-4","py-2","disabled:opacity-50",3,"disabled"],[4,"ngIf"],[1,"text-sm","text-gray-600","text-center"],["routerLink","/auth/signup",1,"text-blue-600","underline"],[1,"text-red-600"]],template:function(a,e){a&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),n(3,"Connexion"),i(),r(4,"form",3),c("ngSubmit",function(){return e.submit()}),r(5,"div")(6,"label",4),n(7,"Email"),i(),s(8,"input",5),u(9,Z,2,0,"small",6),i(),r(10,"div",7)(11,"label",4),n(12,"Mot de passe"),i(),s(13,"input",8),r(14,"button",9),c("click",function(){return e.togglePassword()}),s(15,"i"),i(),u(16,H,2,0,"small",6),i(),r(17,"label",10),s(18,"input",11),n(19," Se souvenir de moi "),i(),u(20,K,2,1,"p",6),r(21,"button",12),u(22,Q,2,0,"span",13)(23,W,2,0,"span",13),i(),r(24,"p",14),n(25," Pas de compte ? "),r(26,"a",15),n(27,"Cr\xE9er un compte"),i()()()()()),a&2&&(l(4),m("formGroup",e.form),l(5),m("ngIf",e.f.email.touched&&e.f.email.invalid),l(4),m("type",e.showPassword?"text":"password"),l(2),h(e.showPassword?"icon-eye-off":"icon-eye"),l(),m("ngIf",e.f.password.touched&&e.f.password.invalid),l(4),m("ngIf",e.error),l(),m("disabled",e.form.invalid||e.loading),l(),m("ngIf",!e.loading),l(),m("ngIf",e.loading))},dependencies:[g,x,P,T,C,q,I,M,k,A,E],encapsulation:2})};function B(t,o){return a=>{let e=a.get(t),p=a.get(o);return!e||!p||e.value===p.value?null:{fieldsMismatch:!0}}}function Y(t,o){t&1&&(r(0,"small",21),n(1," Min 2 caract\xE8res "),i())}function ee(t,o){t&1&&(r(0,"small",21),n(1," Min 2 caract\xE8res "),i())}function te(t,o){t&1&&(r(0,"small",21),n(1," Email invalide "),i())}function ie(t,o){t&1&&(r(0,"small",21),n(1," Adresse trop courte "),i())}function re(t,o){t&1&&(r(0,"small",21),n(1," Le mot de passe doit contenir : "),s(2,"br"),n(3," - 8 caract\xE8res minimum"),s(4,"br"),n(5," - 1 majuscule"),s(6,"br"),n(7," - 1 chiffre"),s(8,"br"),n(9," - 1 caract\xE8re sp\xE9cial "),i())}function ne(t,o){t&1&&(r(0,"small",21),n(1," Les mots de passe ne correspondent pas "),i())}function oe(t,o){if(t&1&&(r(0,"p",21),n(1),i()),t&2){let a=y();l(),w(a.error)}}var V=class t{fb=f(F);auth=f(N);router=f(_);error="";showPwd=!1;showConfirm=!1;passwordPattern=/^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+={}[\]|:;"'<>,.?/]).{8,}$/;form=this.fb.group({firstName:["",[d.required,d.minLength(2)]],lastName:["",[d.required,d.minLength(2)]],email:["",[d.required,d.email]],address:["",[d.required,d.minLength(5)]],passwordGroup:this.fb.group({password:["",[d.required,d.pattern(this.passwordPattern)]],confirm:["",[d.required]]},{validators:B("password","confirm")})});get f(){return this.form.controls}get pg(){return this.form.get("passwordGroup")}togglePwd(){this.showPwd=!this.showPwd}toggleConfirm(){this.showConfirm=!this.showConfirm}submit(){if(this.error="",this.form.invalid){this.form.markAllAsTouched();return}let{firstName:o,lastName:a,email:e,address:p}=this.form.value,J=this.pg.get("password").value;try{this.auth.register({firstName:o,lastName:a,email:e,address:p,password:J}),this.form.disable(),this.router.navigateByUrl("/auth/signin")}catch(U){this.error=U?.message==="EMAIL_EXISTS"?"Cet email est d\xE9j\xE0 utilis\xE9.":"Inscription impossible. R\xE9essayez."}}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=v({type:t,selectors:[["app-signup"]],decls:48,vars:15,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-blue-50","via-white","to-blue-100","p-6"],[1,"bg-white","rounded-2xl","shadow-xl","p-8","w-full","max-w-lg"],[1,"text-2xl","font-bold","mb-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","sm:grid-cols-2","gap-4"],[1,"block","font-medium","mb-1"],["formControlName","firstName",1,"w-full","border","rounded","px-3","py-2"],["class","text-red-600",4,"ngIf"],["formControlName","lastName",1,"w-full","border","rounded","px-3","py-2"],["type","email","formControlName","email",1,"w-full","border","rounded","px-3","py-2"],["formControlName","address",1,"w-full","border","rounded","px-3","py-2"],["formGroupName","passwordGroup"],[1,"relative"],["formControlName","password",1,"w-full","border","rounded","px-3","py-2","pr-10",3,"type"],["type","button","aria-label","Afficher/masquer le mot de passe","tabindex","-1",1,"absolute","right-3","top-2.5","text-gray-500","hover:text-blue-600",3,"click"],[1,"block","font-medium","mb-1","mt-4"],["formControlName","confirm",1,"w-full","border","rounded","px-3","py-2","pr-10",3,"type"],["type","button","aria-label","Afficher/masquer la confirmation du mot de passe","tabindex","-1",1,"absolute","right-3","top-2.5","text-gray-500","hover:text-blue-600",3,"click"],[1,"w-full","bg-blue-600","text-white","rounded","px-4","py-2","disabled:opacity-50",3,"disabled"],[1,"text-sm","text-gray-600","text-center"],["routerLink","/auth/signin",1,"text-blue-600","underline"],[1,"text-red-600"]],template:function(a,e){if(a&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),n(3,"Cr\xE9er un compte"),i(),r(4,"form",3),c("ngSubmit",function(){return e.submit()}),r(5,"div",4)(6,"div")(7,"label",5),n(8,"Pr\xE9nom"),i(),s(9,"input",6),u(10,Y,2,0,"small",7),i(),r(11,"div")(12,"label",5),n(13,"Nom"),i(),s(14,"input",8),u(15,ee,2,0,"small",7),i()(),r(16,"div")(17,"label",5),n(18,"Email"),i(),s(19,"input",9),u(20,te,2,0,"small",7),i(),r(21,"div")(22,"label",5),n(23,"Adresse"),i(),s(24,"input",10),u(25,ie,2,0,"small",7),i(),r(26,"div",11)(27,"label",5),n(28,"Mot de passe"),i(),r(29,"div",12),s(30,"input",13),r(31,"button",14),c("click",function(){return e.togglePwd()}),s(32,"i"),i()(),u(33,re,10,0,"small",7),r(34,"label",15),n(35,"Confirmer le mot de passe"),i(),r(36,"div",12),s(37,"input",16),r(38,"button",17),c("click",function(){return e.toggleConfirm()}),s(39,"i"),i()(),u(40,ne,2,0,"small",7),i(),u(41,oe,2,1,"p",7),r(42,"button",18),n(43," S\u2019inscrire "),i(),r(44,"p",19),n(45," D\xE9j\xE0 un compte ? "),r(46,"a",20),n(47,"Se connecter"),i()()()()()),a&2){let p;l(4),m("formGroup",e.form),l(6),m("ngIf",e.f.firstName.touched&&e.f.firstName.invalid),l(5),m("ngIf",e.f.lastName.touched&&e.f.lastName.invalid),l(5),m("ngIf",e.f.email.touched&&e.f.email.invalid),l(5),m("ngIf",e.f.address.touched&&e.f.address.invalid),l(5),m("type",e.showPwd?"text":"password"),l(2),h(e.showPwd?"icon-eye-off":"icon-eye"),l(),m("ngIf",((p=e.pg.get("password"))==null?null:p.touched)&&((p=e.pg.get("password"))==null?null:p.invalid)),l(4),m("type",e.showConfirm?"text":"password"),l(2),h(e.showConfirm?"icon-eye-off":"icon-eye"),l(),m("ngIf",e.pg.touched&&(e.pg.errors==null?null:e.pg.errors.fieldsMismatch)),l(),m("ngIf",e.error),l(),m("disabled",e.form.invalid)}},dependencies:[g,x,P,T,C,I,M,k,A,L,E],encapsulation:2})};var ae=[{path:"",redirectTo:"signin",pathMatch:"full"},{path:"signin",component:G},{path:"signup",component:V}],D=class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=S({type:t});static \u0275inj=b({imports:[R.forChild(ae),R]})};var O=class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=S({type:t});static \u0275inj=b({imports:[g,D]})};export{O as AuthModule};
