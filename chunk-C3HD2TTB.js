import{j as V}from"./chunk-IW6AFLJC.js";import{a as U}from"./chunk-44UXRYPE.js";import{$ as k,$a as O,$b as J,Ab as C,Bb as v,Ma as D,Qa as m,V as A,Wb as L,Xa as s,Xb as M,Ya as l,Yb as $,Za as r,Zb as q,_ as T,_a as N,_b as j,a as x,ab as E,b as y,bb as P,bc as R,cb as p,d as Q,db as g,e as w,ga as h,gc as z,lb as f,nb as o,ob as B,pb as u,qb as F,xa as i,zb as _}from"./chunk-R6KUZMSD.js";var I=Q(U());function G(a,n){a&1&&(l(0,"div",8)(1,"div",9),o(2,"\u{1F4E6}"),r(),l(3,"p",10),o(4,"Aucune commande pour ce filtre."),r(),l(5,"p",11),o(6,"Commencez par d\xE9couvrir notre catalogue."),r(),l(7,"a",12),o(8,"Aller au catalogue"),r()()),a&2&&(i(7),s("routerLink","/catalog"))}function K(a,n){if(a&1){let e=P();l(0,"button",23),p("click",function(){T(e);let d=g().$implicit,c=g();return k(c.confirmCancel(d))}),N(1,"i",24),r()}}function W(a,n){if(a&1&&(O(0),o(1),E()),a&2){let e=g(2).$implicit;i(),u(" (**** ",e.payment==null?null:e.payment.last4,")")}}function X(a,n){if(a&1&&(O(0),o(1),_(2,"titlecase"),m(3,W,2,1,"ng-container",20),E()),a&2){let e=g().$implicit;i(),u(" \u2022 Paiement: ",C(2,2,e.payment==null?null:e.payment.method)," "),i(2),s("ngIf",e.payment==null?null:e.payment.last4)}}function Y(a,n){if(a&1&&(l(0,"div",25)(1,"div",26),o(2),r(),l(3,"div",27),o(4),r(),l(5,"div",28),o(6),_(7,"number"),r()()),a&2){let e=n.$implicit;i(2),B(e.title),i(2),u("Qt\xE9: ",e.qty),i(2),u("",v(7,3,e.price,"1.2-2")," DT")}}function Z(a,n){if(a&1&&(l(0,"div",13)(1,"div",14)(2,"div",15),o(3),r(),l(4,"div",16)(5,"span",17),o(6),_(7,"titlecase"),r(),m(8,K,2,0,"button",18),r()(),l(9,"div",19),o(10),_(11,"date"),_(12,"number"),m(13,X,4,4,"ng-container",20),r(),l(14,"div",21),m(15,Y,8,6,"div",22),r()()),a&2){let e=n.$implicit,t=g();i(3),u("Commande ",e.number),i(2),s("ngClass",t.badgeClass(e.status)),i(),u(" ",C(7,8,e.status)," "),i(2),s("ngIf",e.status!=="cancelled"&&e.status!=="delivered"),i(2),F(" Pass\xE9e le ",v(11,10,e.date,"mediumDate")," \u2022 Total ",v(12,13,e.total,"1.2-2")," DT "),i(3),s("ngIf",e.payment),i(2),s("ngForOf",e.items)}}var S="app.orders",H=class a{auth=A(z);orders=h([]);filter=h("all");ngOnInit(){let n=JSON.parse(localStorage.getItem(S)||"[]"),e=this.auth.currentUser(),t=e?n.filter(d=>d.userId===e.id):n.filter(d=>d.userId==null);t.sort((d,c)=>c.date>d.date?1:-1),this.orders.set(t)}displayed(){let n=this.filter();return this.orders().filter(e=>n==="all"?!0:e.status===n)}badgeClass(n){return{paid:"bg-indigo-100 text-indigo-800",processing:"bg-amber-100 text-amber-800",shipped:"bg-blue-100 text-blue-800",delivered:"bg-emerald-100 text-emerald-800",cancelled:"bg-rose-100 text-rose-800"}[n]}confirmCancel(n){return w(this,null,function*(){if(n.status==="delivered"||!(yield I.default.fire({icon:"warning",title:"Annuler cette commande ?",text:'Cette action marquera la commande comme "Annul\xE9e".',showCancelButton:!0,confirmButtonText:"Oui, annuler",cancelButtonText:"Non",confirmButtonColor:"#e11d48"})).isConfirmed)return;let t=this.orders().map(b=>b.id===n.id?y(x({},b),{status:"cancelled"}):b);this.orders.set(t);let d=JSON.parse(localStorage.getItem(S)||"[]"),c=d.findIndex(b=>b.id===n.id);c>=0&&(d[c]=y(x({},d[c]),{status:"cancelled"}),localStorage.setItem(S,JSON.stringify(d))),I.default.fire({icon:"success",title:"Commande annul\xE9e",timer:1300,showConfirmButton:!1})})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=D({type:a,selectors:[["app-account-orders"]],decls:18,vars:22,consts:[[1,"p-6","lg:p-8"],[1,"flex","items-center","justify-between","gap-3","mb-6"],[1,"text-xl","font-semibold"],[1,"flex","gap-2"],[1,"px-3","py-1.5","rounded-lg","border",3,"click"],["class","text-center p-10 rounded-xl border bg-white",4,"ngIf"],[1,"space-y-4"],["class","rounded-xl border bg-white p-4 md:p-6 hover:shadow-lg transition",4,"ngFor","ngForOf"],[1,"text-center","p-10","rounded-xl","border","bg-white"],[1,"text-5xl","mb-2"],[1,"font-medium"],[1,"text-gray-500"],[1,"inline-block","mt-3","px-4","py-2","rounded-lg","bg-blue-600","text-white",3,"routerLink"],[1,"rounded-xl","border","bg-white","p-4","md:p-6","hover:shadow-lg","transition"],[1,"flex","flex-wrap","items-center","justify-between","gap-2"],[1,"font-semibold"],[1,"flex","items-center","gap-3"],[1,"text-sm","rounded-full","px-3","py-1.5",3,"ngClass"],["class","p-2 rounded-lg border hover:bg-rose-50 hover:border-rose-300 text-rose-600","title","Annuler cette commande",3,"click",4,"ngIf"],[1,"text-sm","text-gray-500","mt-1"],[4,"ngIf"],[1,"mt-4","grid","sm:grid-cols-2","lg:grid-cols-3","gap-3"],["class","rounded-lg border p-3 bg-gray-50",4,"ngFor","ngForOf"],["title","Annuler cette commande",1,"p-2","rounded-lg","border","hover:bg-rose-50","hover:border-rose-300","text-rose-600",3,"click"],[1,"icon-trash"],[1,"rounded-lg","border","p-3","bg-gray-50"],[1,"font-medium","truncate"],[1,"text-sm","text-gray-600"],[1,"text-sm"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Historique des commandes"),r(),l(4,"div",3)(5,"button",4),p("click",function(){return t.filter.set("all")}),o(6,"Toutes"),r(),l(7,"button",4),p("click",function(){return t.filter.set("processing")}),o(8,"En traitement"),r(),l(9,"button",4),p("click",function(){return t.filter.set("shipped")}),o(10,"Exp\xE9di\xE9es"),r(),l(11,"button",4),p("click",function(){return t.filter.set("delivered")}),o(12,"Livr\xE9es"),r(),l(13,"button",4),p("click",function(){return t.filter.set("cancelled")}),o(14,"Annul\xE9es"),r()()(),m(15,G,9,1,"div",5),l(16,"div",6),m(17,Z,16,16,"div",7),r()()),e&2&&(i(5),f("bg-blue-600",t.filter()==="all")("text-white",t.filter()==="all"),i(2),f("bg-amber-600",t.filter()==="processing")("text-white",t.filter()==="processing"),i(2),f("bg-blue-600",t.filter()==="shipped")("text-white",t.filter()==="shipped"),i(2),f("bg-emerald-600",t.filter()==="delivered")("text-white",t.filter()==="delivered"),i(2),f("bg-rose-600",t.filter()==="cancelled")("text-white",t.filter()==="cancelled"),i(2),s("ngIf",t.displayed().length===0),i(2),s("ngForOf",t.displayed()))},dependencies:[R,L,M,$,V,J,q,j],encapsulation:2})};export{H as AccountOrders};
