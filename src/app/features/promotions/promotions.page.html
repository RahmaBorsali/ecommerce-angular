<div class="min-h-screen bg-[var(--bg-light,#f9fafb)]">
  <app-header></app-header>

  <main class="container mx-auto px-4 py-10">
    <!-- ðŸ”„ Loading -->
    <div *ngIf="loading" class="flex items-center justify-center py-24">
      <div class="animate-pulse w-16 h-16 rounded-full bg-amber-500 shadow-lg"></div>
    </div>

    <!-- âš ï¸ Erreur -->
    <div
      *ngIf="!loading && error"
      class="min-h-[40vh] flex items-center justify-center bg-gray-50 rounded-xl"
    >
      <div class="text-center">
        <h1 class="text-2xl font-bold text-gray-900 mb-4">Une erreur est survenue</h1>
        <button
          (click)="reload()"
          class="px-6 py-2.5 bg-blue-600 text-white font-medium rounded-lg shadow-md hover:bg-blue-500 hover:shadow-lg active:scale-95 transition-all duration-200"
        >
          ðŸ”„ Recharger la page
        </button>
      </div>
    </div>

    <!-- ðŸŽ Promotions -->
    <section *ngIf="!loading && !error" class="space-y-6" aria-label="Promotions">
      <div class="text-center mb-10">
        <div
          class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-orange-50 text-orange-600 text-sm font-semibold shadow-sm ring-1 ring-orange-100"
        >
          <i class="icon-zap"></i> OFFRES SPÃ‰CIALES
        </div>
        <h2 class="mt-4 text-3xl md:text-4xl font-extrabold text-gray-900">
          Promotions Exceptionnelles
        </h2>
        <p class="text-gray-500 mt-1">
          Jusqu'Ã  -35% sur une sÃ©lection de produits
        </p>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <article
          *ngFor="let p of promos"
          class="bg-white rounded-2xl shadow-[0_5px_20px_rgba(0,0,0,0.08)] border border-gray-100 overflow-hidden hover:shadow-[0_8px_25px_rgba(0,0,0,0.12)] transition-all duration-300 hover:-translate-y-1"
        >
          <!-- ðŸ–¼ï¸ Image avec badge -->
          <div class="relative">
            <img
              [src]="p.image"
              [alt]="p.title"
              class="w-full h-48 md:h-56 object-cover"
            />

            <!-- âœ… Badge de rÃ©duction au-dessus -->
            <div
              *ngIf="p.discountPercent"
              class="absolute top-3 right-3 h-12 w-12 bg-rose-600 text-white text-sm font-bold rounded-full grid place-items-center shadow-lg"
            >
              -{{ p.discountPercent }}%
            </div>
          </div>

          <!-- Infos produit -->
          <div class="p-4">
            <h3 class="font-semibold text-base md:text-lg mb-1 text-gray-800 line-clamp-2">
              {{ p.title }}
            </h3>

            <!-- â­ Rating -->
            <div class="flex items-center gap-1 text-amber-500 text-xs mb-2">
              <ng-container *ngFor="let s of [1,2,3,4,5]">
                <span>{{ s <= Math.round(p.rating || 0) ? 'â˜…' : 'â˜†' }}</span>
              </ng-container>
              <span class="text-gray-500 ml-1">({{ p.rating | number:'1.1-1' }})</span>
            </div>

            <!-- ðŸ’° Prix -->
            <div class="flex items-baseline gap-2 mb-3">
              <span class="text-rose-600 font-extrabold text-lg">
                {{ p.price | number:'1.2-2' }} â‚¬
              </span>
              <span *ngIf="p.oldPrice" class="text-gray-400 line-through text-sm">
                {{ p.oldPrice | number:'1.2-2' }} â‚¬
              </span>
            </div>

            <!-- ðŸ”˜ Boutons -->
            <div class="flex items-center gap-2">
              <a
                [routerLink]="['/products', p.id]"
                class="flex-1 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg shadow-md hover:bg-blue-500 hover:shadow-lg active:scale-95 transition-all duration-200 text-center"
              >
                Voir le produit
              </a>

              <button
                (click)="addToCart(p)"
                class="w-10 h-10 rounded-lg bg-amber-500 text-white grid place-items-center shadow-md hover:bg-amber-400 hover:shadow-lg active:scale-95 transition-all"
                title="Ajouter au panier"
              >
                <i class="icon-shopping-cart text-base"></i>
              </button>
            </div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <app-footer></app-footer>
</div>
