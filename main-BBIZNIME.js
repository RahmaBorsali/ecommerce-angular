import{a as $,b as te}from"./chunk-CLVDU3HE.js";import{a as D,b as M}from"./chunk-X7VRKKFN.js";import{a as Ye}from"./chunk-IR4MGW63.js";import{a as Le,b as qe,c as je,g as Z,h as Ge,i as j,j as G,l as Ue}from"./chunk-IW6AFLJC.js";import{a as $e,b as z,c as S,d as W,e as X,f as ze,g as me,h as ee,i as We,j as de,l as pe,m as He,n as Qe,o as Ke,p as Je,q as ue,r as ge,s as fe}from"./chunk-PI5CFJYO.js";import{a as ce}from"./chunk-44UXRYPE.js";import{$ as h,$a as V,$b as q,Bb as b,Cb as oe,D as re,Eb as Re,Ha as Fe,Ma as E,Q as Ie,Qa as u,V as _,Wa as De,Wb as Ae,Xa as c,Xb as F,Ya as r,Yb as k,Za as n,_ as x,_a as p,_b as Be,ab as R,ac as Oe,bb as C,bc as T,cb as g,d as se,db as m,e as N,fa as Pe,ga as ke,gc as U,ja as Te,jb as ne,kb as Me,lb as w,nb as a,ob as y,pb as f,qb as Ne,rb as A,sb as B,tb as O,ua as P,vb as Ve,xa as l,xb as Q,yb as L,zb as v}from"./chunk-R6KUZMSD.js";var H=se(ce());function lt(t,i){if(t&1){let e=C();r(0,"button",6),g("click",function(){x(e);let s=m();return h(s.clearAll())}),a(1," Vider le panier "),n()}}function st(t,i){t&1&&(r(0,"div",7),p(1,"div",8),r(2,"h2",9),a(3,"Votre panier est vide"),n(),r(4,"p",10),a(5,"D\xE9couvrez nos derni\xE8res nouveaut\xE9s et promos."),n(),r(6,"a",11),a(7," Continuer vos achats "),n()())}function ct(t,i){if(t&1){let e=C();r(0,"div",38)(1,"div",39),p(2,"img",40),r(3,"div",41)(4,"h3",42),a(5),n(),r(6,"p",43),a(7),n(),r(8,"div",44),a(9),v(10,"number"),n()(),r(11,"div",45)(12,"button",46),g("click",function(){let s=x(e).$implicit,d=m(2);return h(d.dec(s))}),a(13," \u2212 "),n(),r(14,"span",47),a(15),n(),r(16,"button",48),g("click",function(){let s=x(e).$implicit,d=m(2);return h(d.inc(s))}),a(17," + "),n()(),r(18,"div",49)(19,"div",50),a(20),v(21,"number"),n(),r(22,"div",51),a(23),v(24,"number"),n()()(),r(25,"div",52)(26,"a",53),a(27,"Voir le produit"),n(),r(28,"button",54),g("click",function(){let s=x(e).$implicit,d=m(2);return h(d.remove(s))}),p(29,"i",55),a(30," Supprimer "),n()()()}if(t&2){let e=i.$implicit;l(2),c("src",e.image,P)("alt",e.name),l(3),y(e.name),l(2),f("R\xE9f. #",e.id),l(2),f(" ",b(10,11,e.price*e.quantity,"1.2-2")," DT "),l(3),c("disabled",e.quantity<=1),l(3),y(e.quantity),l(5),f(" ",b(21,14,e.price*e.quantity,"1.2-2")," DT "),l(3),f("",b(24,17,e.price,"1.2-2")," DT / u"),l(3),c("routerLink",Ve("/products/",e.id))}}function mt(t,i){if(t&1&&(r(0,"span"),a(1),v(2,"number"),n()),t&2){let e=m(2);l(),f(" Manque ",b(2,1,e.meta.freeShippingThreshold-e.subtotal,"1.2-2")," DT ")}}function dt(t,i){t&1&&(r(0,"span",56),a(1,"Obtenue \u2713"),n())}function pt(t,i){if(t&1&&(r(0,"p",57),a(1," Code actif: "),r(2,"strong"),a(3),n()()),t&2){let e=m(2);l(3),y(e.meta.couponCode)}}function ut(t,i){if(t&1&&(r(0,"div",33)(1,"span"),a(2,"Remise"),n(),r(3,"span",58),a(4),v(5,"number"),n()()),t&2){let e=m(2);l(4),f("-",b(5,1,e.discount,"1.2-2")," DT")}}function gt(t,i){if(t&1){let e=C();r(0,"div",12)(1,"div",13),u(2,ct,31,20,"div",14),r(3,"div",15)(4,"a",16),a(5," \u2190 Continuer vos achats "),n()()(),r(6,"aside",17)(7,"div",18)(8,"h2",19),a(9,"R\xE9capitulatif"),n(),r(10,"div",20)(11,"div",21)(12,"span"),a(13),v(14,"number"),n(),u(15,mt,3,4,"span",22)(16,dt,2,0,"span",23),n(),r(17,"div",24),p(18,"div",25),n()(),r(19,"form",26),g("ngSubmit",function(){x(e);let s=m();return h(s.applyCoupon())}),r(20,"input",27),O("ngModelChange",function(s){x(e);let d=m();return B(d.couponCode,s)||(d.couponCode=s),h(s)}),n(),r(21,"button",28),a(22," Appliquer "),n(),r(23,"button",29),g("click",function(){x(e);let s=m();return h(s.clearCoupon())}),p(24,"i",30),n()(),u(25,pt,4,1,"p",31),r(26,"div",32)(27,"div",33)(28,"span"),a(29,"Sous-total"),n(),r(30,"span"),a(31),v(32,"number"),n()(),u(33,ut,6,4,"div",34),r(34,"div",33)(35,"span"),a(36,"Livraison"),n(),r(37,"span"),a(38),v(39,"number"),n()(),r(40,"div",35)(41,"span"),a(42,"Total"),n(),r(43,"span",36),a(44),v(45,"number"),n()()(),r(46,"a",37),g("click",function(){x(e);let s=m();return h(s.proceedToCheckout())}),a(47,` Proc\xE9der au paiement
`),n()()()()}if(t&2){let e=m();l(2),c("ngForOf",e.cart)("ngForTrackBy",e.trackById),l(11),f("Livraison offerte d\xE8s ",b(14,13,e.meta.freeShippingThreshold,"1.0-0")," DT"),l(2),c("ngIf",e.subtotal<e.meta.freeShippingThreshold),l(),c("ngIf",e.subtotal>=e.meta.freeShippingThreshold),l(2),Me("width",e.Math.min(100,e.subtotal/e.meta.freeShippingThreshold*100),"%"),l(2),A("ngModel",e.couponCode),l(5),c("ngIf",e.meta.couponCode),l(6),f("",b(32,16,e.subtotal,"1.2-2")," DT"),l(2),c("ngIf",e.discount>0),l(5),f("",b(39,19,e.shipping,"1.2-2")," DT"),l(6),f("",b(45,22,e.total,"1.2-2")," DT")}}var xe=class t{auth=_(U);router=_(j);Math=Math;cartSvc=_($);cart=[];meta=this.cartSvc.getMeta();couponCode="";onCartUpdated=()=>this.load();onStorage=i=>{(i.key==="cart"||i.key==="cart_meta"||i.key===null)&&this.load()};ngOnInit(){this.load(),window.addEventListener("cartUpdated",this.onCartUpdated),window.addEventListener("storage",this.onStorage)}ngOnDestroy(){window.removeEventListener("cartUpdated",this.onCartUpdated),window.removeEventListener("storage",this.onStorage)}load(){this.cart=this.cartSvc.getCart(),this.meta=this.cartSvc.getMeta()}get subtotal(){return this.cartSvc.calcSubtotal(this.cart)}get discount(){return this.cartSvc.calcDiscount(this.subtotal,this.meta)}get shipping(){return this.cartSvc.calcShipping(this.subtotal,this.meta)}get total(){return this.cartSvc.calcTotal(this.subtotal,this.shipping,this.discount)}trackById=(i,e)=>e.id;dec(i){this.cartSvc.updateQuantity(i.id,i.quantity-1),this.load()}inc(i){this.cartSvc.updateQuantity(i.id,i.quantity+1),this.load()}remove(i){return N(this,null,function*(){(yield H.default.fire({title:"Supprimer cet article ?",text:i.name,icon:"warning",showCancelButton:!0,confirmButtonText:"Oui, supprimer",cancelButtonText:"Annuler",confirmButtonColor:"#dc2626"})).isConfirmed&&(this.cartSvc.removeFromCart(i.id),this.load(),H.default.fire({toast:!0,position:"top-end",icon:"success",title:"Article supprim\xE9",timer:1500,showConfirmButton:!1,timerProgressBar:!0}))})}clearAll(){this.cartSvc.clearCart(),this.load(),H.default.fire({toast:!0,position:"top-end",icon:"success",title:"Panier vid\xE9",timer:1500,showConfirmButton:!1,timerProgressBar:!0})}applyCoupon(){let i=(this.couponCode||"").trim().toUpperCase();i&&(i==="FREESHIP"||i==="SALE10"?(this.meta=this.cartSvc.setMeta({couponCode:i}),this.couponCode="",H.default.fire({toast:!0,position:"top-end",icon:"success",title:i==="FREESHIP"?"Livraison offerte appliqu\xE9e":"Remise 10% appliqu\xE9e",timer:1500,showConfirmButton:!1}),this.load()):H.default.fire({toast:!0,position:"top-end",icon:"error",title:"Code invalide",timer:1500,showConfirmButton:!1}))}clearCoupon(){this.meta=this.cartSvc.setMeta({couponCode:""}),H.default.fire({toast:!0,position:"top-end",icon:"info",title:"Code promo retir\xE9",timer:1200,showConfirmButton:!1}),this.load()}proceedToCheckout(){return N(this,null,function*(){if(!this.auth.currentUser()){(yield H.default.fire({title:"Connexion requise",text:"Veuillez vous connecter pour proc\xE9der au paiement \u{1F499}",icon:"info",showCancelButton:!0,confirmButtonText:"Se connecter",cancelButtonText:"Annuler",confirmButtonColor:"#2563eb",cancelButtonColor:"#6b7280"})).isConfirmed&&this.router.navigate(["/auth/signin"]);return}this.router.navigate(["/checkout"])})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-cart-items"]],decls:10,vars:3,consts:[[1,"mx-auto","max-w-7xl","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6","flex","items-center","justify-between","gap-4"],[1,"text-2xl","md:text-3xl","font-bold","mt-2"],["class","text-sm text-red-600 hover:text-red-700",3,"click",4,"ngIf"],["class","text-center py-16 bg-white rounded-xl shadow-sm",4,"ngIf"],["class","grid grid-cols-1 lg:grid-cols-12 gap-8",4,"ngIf"],[1,"text-sm","text-red-600","hover:text-red-700",3,"click"],[1,"text-center","py-16","bg-white","rounded-xl","shadow-sm"],[1,"icon-shopping-cart","text-6xl","text-gray-300","mb-4"],[1,"text-2xl","font-semibold","mb-2"],[1,"text-gray-500","mb-6"],["routerLink","/home",1,"inline-flex","items-center","rounded-lg","bg-blue-600","px-5","py-3","font-semibold","text-white","hover:bg-blue-500"],[1,"grid","grid-cols-1","lg:grid-cols-12","gap-8"],[1,"lg:col-span-8","space-y-4"],["class","bg-white rounded-xl shadow-sm border border-gray-100 p-4 md:p-5",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","justify-start"],["routerLink","/home",1,"inline-flex","items-center","text-sm","text-gray-600","hover:text-blue-600"],[1,"lg:col-span-4"],[1,"bg-white","rounded-2xl","shadow-md","border","border-gray-100","p-8","sticky","top-24"],[1,"text-xl","font-bold","mb-4"],[1,"mb-4"],[1,"flex","justify-between","text-sm","text-gray-600","mb-1"],[4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf"],[1,"h-2","bg-gray-100","rounded-full","overflow-hidden"],[1,"h-full","bg-green-500"],[1,"mb-4","flex","gap-2",3,"ngSubmit"],["name","coupon","type","text","placeholder","Code promo (ex: SALE10, FREESHIP)",1,"flex-1","border","px-3","h-10","text-sm","rounded-lg",3,"ngModelChange","ngModel"],[1,"h-10","px-4","text-sm","font-medium","bg-gray-900","text-white","hover:bg-gray-800","rounded-lg"],["type","button","title","Retirer le code",1,"h-10","w-10","flex","items-center","justify-center","rounded-full","bg-blue-50","text-blue-600","hover:bg-blue-100","transition",3,"click"],[1,"icon-x","text-lg"],["class","text-xs text-green-700 mb-2",4,"ngIf"],[1,"space-y-3","mb-4","text-sm"],[1,"flex","justify-between"],["class","flex justify-between",4,"ngIf"],[1,"border-t","pt-3","flex","justify-between","text-base","font-bold"],[1,"text-blue-600"],[1,"block","w-full","text-center","rounded-lg","bg-blue-600","text-white","font-semibold","py-3","hover:bg-blue-500","cursor-pointer",3,"click"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-4","md:p-5"],[1,"grid","grid-cols-[80px_1fr_auto_auto]","md:grid-cols-[96px_1fr_auto_auto]","items-center","gap-4","md:gap-6"],[1,"w-20","h-20","md:w-24","md:h-24","object-cover","rounded-lg","border",3,"src","alt"],[1,"min-w-0"],[1,"font-semibold","truncate"],[1,"text-sm","text-gray-500","mt-1"],[1,"mt-2","text-blue-600","font-bold","md:hidden"],[1,"flex","items-center","justify-end","gap-2"],["aria-label","Diminuer",1,"w-8","h-8","rounded-lg","border","hover:bg-gray-50","disabled:opacity-40",3,"click","disabled"],[1,"w-10","text-center","font-medium"],["aria-label","Augmenter",1,"w-8","h-8","rounded-lg","border","hover:bg-gray-50",3,"click"],[1,"hidden","md:block","text-right"],[1,"text-lg","font-semibold"],[1,"text-sm","text-gray-400"],[1,"mt-3","flex","justify-between","text-sm"],[1,"text-gray-500","hover:text-gray-700",3,"routerLink"],[1,"text-red-600","hover:text-red-700","inline-flex","items-center","gap-1",3,"click"],[1,"icon-trash-2"],[1,"text-green-600","font-medium"],[1,"text-xs","text-green-700","mb-2"],[1,"text-green-600"]],template:function(e,o){e&1&&(p(0,"app-header"),r(1,"section",0)(2,"div",1)(3,"div")(4,"h1",2),a(5,"Votre panier"),n()(),u(6,lt,2,0,"button",3),n(),u(7,st,8,0,"div",4)(8,gt,48,25,"div",5),n(),p(9,"app-footer")),e&2&&(l(6),c("ngIf",o.cart.length),l(),c("ngIf",o.cart.length===0),l(),c("ngIf",o.cart.length))},dependencies:[T,F,k,G,D,M,ge,ee,z,W,X,me,ze,q],encapsulation:2})};var J=se(ce());function Ee(t){return(t||"").replace(/\s+/g,"")}function Ze(t){let i=Ee(t);if(!/^\d{13,19}$/.test(i))return!1;let e=0,o=!1;for(let s=i.length-1;s>=0;s--){let d=parseInt(i.charAt(s),10);o&&(d=d*2,d>9&&(d-=9)),e+=d,o=!o}return e%10===0}function Xe(t){let i=(t.value||"").toString(),e=Ee(i);return/^\d{13,19}$/.test(e)?Ze(e)?null:{cardLuhn:!0}:{cardFormat:!0}}function ft(t,i){t&1&&(r(0,"p",41),a(1," Pr\xE9nom requis "),n())}function xt(t,i){t&1&&(r(0,"p",41),a(1," Nom requis "),n())}function ht(t,i){t&1&&(r(0,"p",41),a(1," Adresse requise "),n())}function _t(t,i){t&1&&(r(0,"p",41),a(1," Ville requise "),n())}function vt(t,i){t&1&&(r(0,"p",41),a(1," Code postal requis "),n())}function bt(t,i){t&1&&(r(0,"p",41),a(1," T\xE9l\xE9phone requis "),n())}function yt(t,i){if(t&1){let e=C();r(0,"form",21),g("ngSubmit",function(){x(e);let s=m();return h(s.nextFromStep1())}),r(1,"h2",13),a(2,"Adresse de Livraison"),n(),r(3,"div",22)(4,"div")(5,"label",23),a(6,"Pr\xE9nom *"),n(),p(7,"input",24),u(8,ft,2,0,"p",25),n(),r(9,"div")(10,"label",23),a(11,"Nom *"),n(),p(12,"input",26),u(13,xt,2,0,"p",25),n()(),r(14,"div",27)(15,"label",23),a(16,"Adresse *"),n(),p(17,"input",28),u(18,ht,2,0,"p",25),n(),r(19,"div",29)(20,"div")(21,"label",23),a(22,"Ville *"),n(),p(23,"input",30),u(24,_t,2,0,"p",25),n(),r(25,"div")(26,"label",23),a(27,"Code Postal *"),n(),p(28,"input",31),u(29,vt,2,0,"p",25),n()(),r(30,"div",27)(31,"label",23),a(32,"T\xE9l\xE9phone *"),n(),p(33,"input",32),u(34,bt,2,0,"p",25),n(),r(35,"h3",33),a(36,"Mode de Livraison"),n(),r(37,"label",34),p(38,"input",35),r(39,"div",36)(40,"p",37),a(41,"Express"),n(),r(42,"p",38),a(43,"Livraison rapide (facultatif)"),n()(),r(44,"span",39),a(45,"+ 4.00 DT"),n()(),r(46,"button",40),a(47," Continuer "),n()()}if(t&2){let e=m();c("formGroup",e.step1),l(8),c("ngIf",e.step1.controls.firstName.touched&&e.step1.controls.firstName.invalid),l(5),c("ngIf",e.step1.controls.lastName.touched&&e.step1.controls.lastName.invalid),l(5),c("ngIf",e.step1.controls.address.touched&&e.step1.controls.address.invalid),l(6),c("ngIf",e.step1.controls.city.touched&&e.step1.controls.city.invalid),l(5),c("ngIf",e.step1.controls.postalCode.touched&&e.step1.controls.postalCode.invalid),l(5),c("ngIf",e.step1.controls.phone.touched&&e.step1.controls.phone.invalid),l(12),c("disabled",e.step1.invalid)}}function St(t,i){t&1&&(r(0,"small",66),a(1," Num\xE9ro invalide. "),n())}function Ct(t,i){if(t&1){let e=C();r(0,"form",54),g("ngSubmit",function(){x(e);let s=m(2);return h(s.pay())}),r(1,"div")(2,"label",55),a(3,"Num\xE9ro de carte"),n(),r(4,"input",56),g("input",function(s){x(e);let d=m(2);return h(d.formatCardNumber(s))}),n(),u(5,St,2,0,"small",57),n(),r(6,"div",58)(7,"div",59)(8,"label",55),a(9,"Nom sur la carte"),n(),p(10,"input",60),n(),r(11,"div")(12,"label",55),a(13,"CVV"),n(),p(14,"input",61),n()(),r(15,"div")(16,"label",55),a(17,"Date d'expiration (MM/AA)"),n(),p(18,"input",62),n(),r(19,"div",63)(20,"button",64),g("click",function(){x(e);let s=m(2);return h(s.backToStep1())}),a(21," Retour "),n(),r(22,"button",65),a(23),n()()()}if(t&2){let e=m(2);c("formGroup",e.step2),l(5),c("ngIf",e.step2.controls.cardNumber.touched&&e.step2.controls.cardNumber.invalid),l(17),c("disabled",e.loading),l(),f(" ",e.loading?"Paiement\u2026":"Payer avec la carte"," ")}}function wt(t,i){t&1&&(r(0,"small",66),a(1," Email requis et valide. "),n())}function Et(t,i){if(t&1){let e=C();r(0,"form",54),g("ngSubmit",function(){x(e);let s=m(2);return h(s.pay())}),r(1,"div")(2,"label",55),a(3,"Email PayPal"),n(),p(4,"input",67),u(5,wt,2,0,"small",57),n(),r(6,"div",63)(7,"button",64),g("click",function(){x(e);let s=m(2);return h(s.backToStep1())}),a(8," Retour "),n(),r(9,"button",65),a(10),n()()()}if(t&2){let e=m(2);c("formGroup",e.paypalForm),l(5),c("ngIf",e.paypalForm.controls.email.touched&&e.paypalForm.controls.email.invalid),l(4),c("disabled",e.loading),l(),f(" ",e.loading?"Traitement\u2026":"Payer avec PayPal"," ")}}function It(t,i){if(t&1){let e=C();r(0,"form",54),g("ngSubmit",function(){x(e);let s=m(2);return h(s.pay())}),r(1,"div",68)(2,"div")(3,"label",55),a(4,"Nom complet"),n(),p(5,"input",69),n(),r(6,"div")(7,"label",55),a(8,"T\xE9l\xE9phone"),n(),p(9,"input",70),n()(),r(10,"div",63)(11,"button",64),g("click",function(){x(e);let s=m(2);return h(s.backToStep1())}),a(12," Retour "),n(),r(13,"button",65),a(14),n()()()}if(t&2){let e=m(2);c("formGroup",e.walletForm),l(13),c("disabled",e.loading),l(),f(" ",e.loading?"Traitement\u2026":e.method==="applepay"?"Payer avec Apple Pay":"Payer avec Google Pay"," ")}}function Pt(t,i){if(t&1){let e=C();r(0,"div",42)(1,"h3",43),a(2,"Choix du moyen de paiement"),n(),r(3,"div",44)(4,"button",45),g("click",function(){x(e);let s=m();return h(s.selectMethod("card"))}),r(5,"div",46),p(6,"i",47),r(7,"div")(8,"div",37),a(9,"Carte bancaire"),n(),r(10,"div",48),a(11,"Visa / MasterCard"),n()()()(),r(12,"button",45),g("click",function(){x(e);let s=m();return h(s.selectMethod("paypal"))}),r(13,"div",46),p(14,"i",49),r(15,"div")(16,"div",37),a(17,"PayPal"),n(),r(18,"div",48),a(19,"Payer avec PayPal"),n()()()(),r(20,"button",45),g("click",function(){x(e);let s=m();return h(s.selectMethod("applepay"))}),r(21,"div",46),p(22,"i",50),r(23,"div")(24,"div",37),a(25,"Apple Pay"),n(),r(26,"div",48),a(27,"Paiement rapide"),n()()()(),r(28,"button",45),g("click",function(){x(e);let s=m();return h(s.selectMethod("googlepay"))}),r(29,"div",46),p(30,"i",51),r(31,"div")(32,"div",37),a(33,"Google Pay"),n(),r(34,"div",48),a(35,"Paiement rapide"),n()()()()(),r(36,"div",52),u(37,Ct,24,4,"form",53)(38,Et,11,4,"form",53)(39,It,15,3,"form",53),n()()}if(t&2){let e=m();l(4),w("border-blue-600",e.method==="card"),l(8),w("border-blue-600",e.method==="paypal"),l(8),w("border-blue-600",e.method==="applepay"),l(8),w("border-blue-600",e.method==="googlepay"),l(9),c("ngIf",e.method==="card"),l(),c("ngIf",e.method==="paypal"),l(),c("ngIf",e.method==="applepay"||e.method==="googlepay")}}function kt(t,i){if(t&1){let e=C();r(0,"div",71)(1,"img",72),g("error",function(s){let d=x(e).$implicit,I=m();return h(I.onImgError(s,d))}),n(),r(2,"div",36)(3,"p",73),a(4),n(),r(5,"p",38),a(6),n()(),r(7,"span",39),a(8),v(9,"number"),n()()}if(t&2){let e=i.$implicit;l(),c("src",e.image,P)("alt",e.name),l(3),y(e.name),l(2),f("Qt\xE9: ",e.quantity),l(2),f("",b(9,5,e.price*e.quantity,"1.2-2")," DT")}}function Tt(t,i){if(t&1&&(r(0,"div",17)(1,"span"),a(2,"Remise"),n(),r(3,"span",74),a(4),v(5,"number"),n()()),t&2){let e=m();l(4),f("-",b(5,1,e.discount,"1.2-2")," DT")}}var he=class t{auth=_(U);fb=_(ue);router=_(j);cartSvc=_($);step=1;loading=!1;cart=[];meta=this.cartSvc.getMeta();method="card";step1=this.fb.nonNullable.group({firstName:["",S.required],lastName:["",S.required],address:["",S.required],city:["",S.required],postalCode:["",S.required],phone:["",S.required],useExpress:[!1]});step2=this.fb.nonNullable.group({cardNumber:["",[S.required,Xe]],cardName:["",S.required],expiryDate:["",[S.required,S.pattern(/^\d{2}\/\d{2}$/)]],cvv:["",[S.required,S.pattern(/^\d{3,4}$/)]]});onCartUpdated=()=>{this.cart=this.cartSvc.getCart(),this.meta=this.cartSvc.getMeta()};formatCardNumber(i){let e=i.target,o=(e.value||"").replace(/\D+/g,"").slice(0,19);e.value=o.replace(/(.{4})/g,"$1 ").trim(),this.step2.controls.cardNumber.setValue(e.value,{emitEvent:!1})}ngOnInit(){if(this.cart=this.cartSvc.getCart(),this.meta=this.cartSvc.getMeta(),!this.cart.length){this.router.navigate(["/cart"]);return}window.addEventListener("cartUpdated",this.onCartUpdated),window.addEventListener("storage",this.onCartUpdated)}ngOnDestroy(){window.removeEventListener("cartUpdated",this.onCartUpdated),window.removeEventListener("storage",this.onCartUpdated)}get subtotal(){return this.cartSvc.calcSubtotal(this.cart)}get discount(){return this.cartSvc.calcDiscount(this.subtotal,this.meta)}get shipping(){let i=this.step1.controls.useExpress.value===!0;return this.cartSvc.calcShipping(this.subtotal,this.meta,{express:i})}get total(){return this.cartSvc.calcTotal(this.subtotal,this.shipping,this.discount)}nextFromStep1(){if(this.step1.invalid){this.step1.markAllAsTouched(),J.default.fire({icon:"warning",title:"Champs manquants",text:"Merci de compl\xE9ter vos informations."});return}this.step=2}backToStep1(){this.step=1}paypalForm=this.fb.nonNullable.group({email:["",[S.required,S.email]]});walletForm=this.fb.nonNullable.group({fullName:["",[S.required,S.minLength(2)]],phone:["",[S.required]]});selectMethod(i){this.method=i}pay(){return N(this,null,function*(){if(this.step2.invalid){this.step2.markAllAsTouched(),J.default.fire({icon:"warning",title:"Informations de carte invalides",text:"Merci de v\xE9rifier vos informations bancaires."});return}this.loading=!0,J.default.fire({title:"Paiement en cours\u2026",allowOutsideClick:!1,didOpen:()=>J.default.showLoading(),showConfirmButton:!1,backdrop:!0}),setTimeout(()=>{J.default.close();try{let o="app.orders",s=JSON.parse(localStorage.getItem(o)||"[]"),d="ES-"+new Date().toISOString().slice(0,10).replace(/-/g,"")+"-"+String(Math.floor(Math.random()*1e4)).padStart(4,"0"),I={id:crypto.randomUUID(),number:d,date:new Date().toISOString(),total:this.total,status:"processing",userId:this.auth?.currentUser()?.id??null,items:this.cart.map(Y=>({title:Y.name,qty:Y.quantity,price:Y.price,image:Y.image}))};s.unshift(I),localStorage.setItem(o,JSON.stringify(s))}catch{}this.cartSvc.clearCart(),this.cartSvc.setMeta({couponCode:""}),J.default.fire({icon:"success",title:"Commande confirm\xE9e \u2705",text:"Merci pour votre achat !"});let i="ES-"+new Date().toISOString().slice(0,10).replace(/-/g,"")+"-"+String(Math.floor(Math.random()*1e4)).padStart(4,"0"),e=new Date;e.setDate(e.getDate()+7),this.router.navigate(["/order/success"],{state:{orderNumber:i,estimatedDelivery:e.toISOString()}}),this.loading=!1},1500)})}onImgError(i,e){let o=i.target;e.image?.includes("images.unsplash.com")&&!o.src.includes("w=")?o.src=e.image+(e.image.includes("?")?"&":"?")+"auto=format&w=200&q=60":o.src="assets/placeholder-100x100.png"}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-checkout"]],decls:42,vars:30,consts:[[1,"max-w-6xl","mx-auto","px-4","md:px-6","lg:px-8","py-8"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6","mb-8"],[1,"flex","items-center"],[1,"w-10","h-10","rounded-full","flex","items-center","justify-center"],[1,"flex-1","h-1","mx-3","bg-gray-200"],[1,"h-full"],[1,"grid","grid-cols-1","lg:grid-cols-12","gap-8"],[1,"lg:col-span-8"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","mt-6",4,"ngIf"],[1,"lg:col-span-4"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-100","p-6","sticky","top-24"],[1,"text-xl","font-bold","mb-4"],[1,"space-y-3","mb-4","max-h-60","overflow-y-auto"],["class","flex gap-3",4,"ngFor","ngForOf"],[1,"border-t","pt-4","space-y-2","text-sm"],[1,"flex","justify-between"],["class","flex justify-between",4,"ngIf"],[1,"border-t","pt-2","flex","justify-between","font-bold","text-lg"],[1,"text-[#2563eb]"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"text-sm","font-medium","mb-1","block"],["formControlName","firstName",1,"w-full","px-3","py-2","border","rounded-lg"],["class","text-red-600 text-xs mt-1",4,"ngIf"],["formControlName","lastName",1,"w-full","px-3","py-2","border","rounded-lg"],[1,"mt-4"],["formControlName","address",1,"w-full","px-3","py-2","border","rounded-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mt-4"],["formControlName","city",1,"w-full","px-3","py-2","border","rounded-lg"],["formControlName","postalCode",1,"w-full","px-3","py-2","border","rounded-lg"],["formControlName","phone",1,"w-full","px-3","py-2","border","rounded-lg"],[1,"text-lg","font-semibold","mt-6","mb-3"],[1,"flex","items-center","p-4","border","rounded-lg","cursor-pointer","hover:bg-gray-50","select-none"],["type","checkbox","formControlName","useExpress",1,"mr-3"],[1,"flex-1"],[1,"font-semibold"],[1,"text-sm","text-gray-600"],[1,"font-bold"],["type","submit",1,"mt-6","w-full","bg-[#2563eb]","hover:bg-[#1d4ed8]","text-white","py-3","rounded-lg","font-semibold",3,"disabled"],[1,"text-red-600","text-xs","mt-1"],[1,"mt-6"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-2","sm:grid-cols-4","gap-3","mb-6"],["type","button",1,"w-full","p-4","rounded-xl","border","bg-white","shadow-sm","hover:shadow-md","text-left","transition",3,"click"],[1,"flex","items-center","gap-3"],[1,"icon-credit-card","text-2xl","text-blue-600"],[1,"text-xs","text-gray-500"],[1,"icon-paypal","text-2xl","text-blue-700"],[1,"icon-apple","text-2xl"],[1,"icon-credit-card","text-2xl"],[1,"rounded-2xl","border","bg-white","p-5","sm:p-6","shadow-sm"],["class","space-y-4",3,"formGroup","ngSubmit",4,"ngIf"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-sm","mb-1"],["formControlName","cardNumber","type","text","placeholder","4242 4242 4242 4242",1,"w-full","border","rounded-lg","px-3","py-2",3,"input"],["class","text-red-600",4,"ngIf"],[1,"grid","sm:grid-cols-3","gap-4"],[1,"sm:col-span-2"],["formControlName","cardName",1,"w-full","border","rounded-lg","px-3","py-2"],["formControlName","cvv","maxlength","4",1,"w-full","border","rounded-lg","px-3","py-2"],["formControlName","expiryDate","placeholder","MM/AA",1,"w-full","border","rounded-lg","px-3","py-2"],[1,"pt-2","flex","gap-3"],["type","button",1,"px-4","py-2","rounded-lg","border",3,"click"],["type","submit",1,"px-6","py-2","rounded-lg","bg-blue-600","text-white",3,"disabled"],[1,"text-red-600"],["formControlName","email","type","email","placeholder","vous@exemple.com",1,"w-full","border","rounded-lg","px-3","py-2"],[1,"grid","sm:grid-cols-2","gap-4"],["formControlName","fullName",1,"w-full","border","rounded-lg","px-3","py-2"],["formControlName","phone",1,"w-full","border","rounded-lg","px-3","py-2"],[1,"flex","gap-3"],[1,"w-16","h-16","object-cover","rounded","border",3,"error","src","alt"],[1,"font-semibold","text-sm"],[1,"text-green-600"]],template:function(e,o){e&1&&(p(0,"app-header"),r(1,"section",0)(2,"div",1)(3,"div",2)(4,"div",3),a(5," 1 "),n(),r(6,"div",4),p(7,"div",5),n(),r(8,"div",3),a(9," 2 "),n()()(),r(10,"div",6)(11,"div",7)(12,"div",8),u(13,yt,48,8,"form",9)(14,Pt,40,11,"div",10),n()(),r(15,"aside",11)(16,"div",12)(17,"h2",13),a(18,"R\xE9capitulatif"),n(),r(19,"div",14),u(20,kt,10,8,"div",15),n(),r(21,"div",16)(22,"div",17)(23,"span"),a(24,"Sous-total"),n(),r(25,"span"),a(26),v(27,"number"),n()(),u(28,Tt,6,4,"div",18),r(29,"div",17)(30,"span"),a(31,"Livraison"),n(),r(32,"span"),a(33),v(34,"number"),n()(),r(35,"div",19)(36,"span"),a(37,"Total"),n(),r(38,"span",20),a(39),v(40,"number"),n()()()()()()(),p(41,"app-footer")),e&2&&(l(4),w("bg-blue-600",o.step>=1)("text-white",o.step>=1)("bg-gray-200",o.step<1),l(3),w("bg-blue-600",o.step>=2),l(),w("bg-blue-600",o.step>=2)("text-white",o.step>=2)("bg-gray-200",o.step<2),l(5),c("ngIf",o.step===1),l(),c("ngIf",o.step===2),l(6),c("ngForOf",o.cart),l(6),f("",b(27,21,o.subtotal,"1.2-2")," DT"),l(2),c("ngIf",o.discount>0),l(5),f("",b(34,24,o.shipping,"1.2-2")," DT"),l(6),f("",b(40,27,o.total,"1.2-2")," DT"))},dependencies:[T,F,k,fe,ee,z,$e,W,X,Je,de,pe,M,D,q],encapsulation:2})};var tt=se(ce());var et=t=>["/products",t],Ft=()=>[1,2,3,4,5];function Dt(t,i){if(t&1&&(r(0,"option",22),a(1),n()),t&2){let e=i.$implicit;c("value",e),l(),y(e)}}function Mt(t,i){if(t&1&&(r(0,"span",36),a(1),n()),t&2){let e=i.$implicit,o=m().$implicit,s=m();l(),f(" ",e<=s.rateRounded(o)?"\u2605":"\u2606"," ")}}function Nt(t,i){if(t&1){let e=C();r(0,"article",23)(1,"a",24),p(2,"img",25),n(),r(3,"div",26)(4,"a",27)(5,"h3",28),a(6),n()(),r(7,"div",29),u(8,Mt,2,1,"span",30),r(9,"span",31),a(10),v(11,"number"),n()(),r(12,"div",32)(13,"span",33),a(14),v(15,"number"),n(),r(16,"button",34),g("click",function(){let s=x(e).$implicit,d=m();return h(d.addToCart(s))}),p(17,"i",35),n()()()()}if(t&2){let e=i.$implicit,o=m();l(),c("routerLink",L(14,et,e.id)),l(),c("src",e.image,P)("alt",e.title),l(2),c("routerLink",L(16,et,e.id)),l(2),y(e.title),l(2),c("ngForOf",Q(18,Ft)),l(2),f("(",b(11,8,o.rateRaw(e),"1.1-1"),")"),l(4),f("",b(15,11,e.price,"1.2-2")," DT")}}function Vt(t,i){if(t&1){let e=C();r(0,"button",39),g("click",function(){let s=x(e).$implicit,d=m(2);return h(d.goPage(s))}),a(1),n()}if(t&2){let e=i.$implicit,o=m(2);w("bg-blue-600",o.currentPage===e)("text-white",o.currentPage===e)("bg-gray-200",o.currentPage!==e),l(),f(" ",e," ")}}function Rt(t,i){if(t&1&&(r(0,"div",37),u(1,Vt,2,7,"button",38),n()),t&2){let e=m();l(),c("ngForOf",e.pages)}}var _e=class t{constructor(i){this.cart=i}products=[];categories=[];initialCategory="";selectedCategory="";priceMax=2e3;maxPriceCeil=2e3;minRating=0;sortBy="";searchQuery="";productsPerPage=12;currentPage=1;filtered=[];pageItems=[];ngOnChanges(i){if(i.products?.currentValue){let e=Math.max(...this.products.map(o=>o.price||0),0);this.maxPriceCeil=Math.ceil(e||2e3),this.priceMax=this.maxPriceCeil}i.initialCategory&&(this.selectedCategory=this.initialCategory||""),this.applyAll()}applyAll(){this.filtered=this.computeFiltered(),this.currentPage=1,this.slicePage()}computeFiltered(){let i=[...this.products];if(this.selectedCategory&&(i=i.filter(e=>e.category===this.selectedCategory)),this.searchQuery){let e=this.searchQuery.toLowerCase();i=i.filter(o=>(o.title||"").toLowerCase().includes(e)||(o.description||"").toLowerCase().includes(e))}return i=i.filter(e=>e.price>=0&&e.price<=this.priceMax),this.minRating>0&&(i=i.filter(e=>(e.rating||0)>=this.minRating)),this.sortBy==="price-asc"&&i.sort((e,o)=>e.price-o.price),this.sortBy==="price-desc"&&i.sort((e,o)=>o.price-e.price),this.sortBy==="rating"&&i.sort((e,o)=>(o.rating||0)-(e.rating||0)),i}slicePage(){let i=(this.currentPage-1)*this.productsPerPage,e=i+this.productsPerPage;this.pageItems=this.filtered.slice(i,e)}get totalPages(){return Math.max(1,Math.ceil(this.filtered.length/this.productsPerPage))}get pages(){return Array.from({length:this.totalPages},(i,e)=>e+1)}goPage(i){this.currentPage=i,this.slicePage()}addToCart(i){this.cart.addToCart({id:i.id,name:i.title,price:i.price,image:i.image,quantity:1}),tt.default.fire({toast:!0,position:"top-end",icon:"success",title:"Ajout\xE9 au panier \u{1F6D2}",timer:1200,showConfirmButton:!1})}rateRounded(i){return Math.floor(i?.rating??0)}rateRaw(i){return i?.rating??0}static \u0275fac=function(e){return new(e||t)(Fe($))};static \u0275cmp=E({type:t,selectors:[["app-product-grid"]],inputs:{products:"products",categories:"categories",initialCategory:"initialCategory"},features:[Te],decls:44,vars:17,consts:[[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"lg:w-64","space-y-6"],[1,"bg-white","rounded-lg","shadow-md","p-4"],[1,"font-semibold","mb-3"],[1,"w-full","px-3","py-2","border","border-gray-200","rounded-lg",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","range","min","0",1,"w-full",3,"ngModelChange","input","max","ngModel"],[1,"text-sm","text-gray-600","mt-2"],[3,"ngValue"],[1,"flex-1"],[1,"flex","flex-col","sm:flex-row","justify-between","gap-3","items-center","mb-6"],[1,"text-gray-600"],[1,"flex","gap-2","w-full","sm:w-auto"],["placeholder","Rechercher...",1,"flex-1","sm:w-64","px-3","py-2","border","border-gray-200","rounded-lg",3,"ngModelChange","keyup.enter","ngModel"],[1,"px-4","py-2","border","border-gray-200","rounded-lg",3,"ngModelChange","change","ngModel"],["value","price-asc"],["value","price-desc"],["value","rating"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition",4,"ngFor","ngForOf"],["class","flex justify-center gap-2 mt-8",4,"ngIf"],[3,"value"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","hover:shadow-lg","transition"],[1,"block","bg-white",3,"routerLink"],[1,"w-full","h-48","object-contain","p-3",3,"src","alt"],[1,"p-4"],[3,"routerLink"],[1,"font-semibold","text-lg","mb-2","hover:text-blue-600"],[1,"flex","items-center","mb-2","text-[#f59e0b]"],["class","select-none",4,"ngFor","ngForOf"],[1,"text-sm","text-gray-600","ml-2"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-blue-600"],["title","Ajouter au panier",1,"bg-orange-500","text-white","p-2","rounded-lg","hover:bg-orange-600",3,"click"],[1,"icon-shopping-cart","text-lg"],[1,"select-none"],[1,"flex","justify-center","gap-2","mt-8"],["class","px-4 py-2 rounded",3,"bg-blue-600","text-white","bg-gray-200","click",4,"ngFor","ngForOf"],[1,"px-4","py-2","rounded",3,"click"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"aside",1)(2,"div",2)(3,"h3",3),a(4,"Cat\xE9gorie"),n(),r(5,"select",4),O("ngModelChange",function(d){return B(o.selectedCategory,d)||(o.selectedCategory=d),d}),g("change",function(){return o.applyAll()}),r(6,"option",5),a(7,"Toutes"),n(),u(8,Dt,2,2,"option",6),n()(),r(9,"div",2)(10,"h3",3),a(11,"Prix max."),n(),r(12,"input",7),O("ngModelChange",function(d){return B(o.priceMax,d)||(o.priceMax=d),d}),g("input",function(){return o.applyAll()}),n(),r(13,"div",8),a(14),v(15,"number"),n()(),r(16,"div",2)(17,"h3",3),a(18,"Note minimale"),n(),r(19,"select",4),O("ngModelChange",function(d){return B(o.minRating,d)||(o.minRating=d),d}),g("change",function(){return o.applyAll()}),r(20,"option",9),a(21,"Toutes"),n(),r(22,"option",9),a(23,"4\u2605 et plus"),n(),r(24,"option",9),a(25,"4.5\u2605 et plus"),n()()()(),r(26,"div",10)(27,"div",11)(28,"p",12),a(29),n(),r(30,"div",13)(31,"input",14),O("ngModelChange",function(d){return B(o.searchQuery,d)||(o.searchQuery=d),d}),g("keyup.enter",function(){return o.applyAll()}),n(),r(32,"select",15),O("ngModelChange",function(d){return B(o.sortBy,d)||(o.sortBy=d),d}),g("change",function(){return o.applyAll()}),r(33,"option",5),a(34,"Trier par"),n(),r(35,"option",16),a(36,"Prix \u2191"),n(),r(37,"option",17),a(38,"Prix \u2193"),n(),r(39,"option",18),a(40,"Meilleure note"),n()()()(),r(41,"div",19),u(42,Nt,18,19,"article",20),n(),u(43,Rt,2,1,"div",21),n()()),e&2&&(l(5),A("ngModel",o.selectedCategory),l(3),c("ngForOf",o.categories),l(4),c("max",o.maxPriceCeil),A("ngModel",o.priceMax),l(2),f("0 \u2013 ",b(15,14,o.priceMax,"1.0-0")," DT"),l(5),A("ngModel",o.minRating),l(),c("ngValue",0),l(2),c("ngValue",4),l(2),c("ngValue",4.5),l(5),f("",o.filtered.length," produits"),l(2),A("ngModel",o.searchQuery),l(),A("ngModel",o.sortBy),l(10),c("ngForOf",o.pageItems),l(),c("ngIf",o.totalPages>1))},dependencies:[T,F,k,G,ge,Qe,Ke,z,We,He,W,me,q],encapsulation:2})};function At(t,i){t&1&&(r(0,"div",6),a(1,"Chargement\u2026"),n())}function Bt(t,i){if(t&1){let e=C();r(0,"div",7)(1,"h2",8),a(2,"Une erreur est survenue"),n(),r(3,"p",9),a(4,"Impossible de charger les produits."),n(),r(5,"button",10),g("click",function(){x(e);let s=m();return h(s.reload())}),a(6," R\xE9essayer "),n()()}}var Ot=new Set(["electronique","men's clothing","women's clothing","jewelery"]),Lt={"womens clothing":"women's clothing","women%27s clothing":"women's clothing","mens clothing":"men's clothing","men%27s clothing":"men's clothing",electronics:"electronique",jewelry:"jewelery"};function qt(t){if(!t)return"";let i=t.trim().toLowerCase();return Lt[i]??t}var jt={electronics:"electronique",jewelery:"jewelery","men's clothing":"men's clothing","women's clothing":"women's clothing"};function Gt(t){let i=jt[t.category]??t.category;return{id:`fs-${t.id}`,title:t.title,description:t.description,price:t.price,image:t.image,category:it(i),rating:t.rating?.rate??0}}function Ut(t){let i=new Set;for(let e of t)e?.category&&Ot.has(e.category)&&i.add(e.category);return Array.from(i)}function it(t){if(!t)return"";let i=t.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),e={"vetements femme":"women's clothing","vetement femme":"women's clothing",femme:"women's clothing","vetements homme":"men's clothing","vetement homme":"men's clothing",homme:"men's clothing",bijoux:"jewelery",electronique:"electronique",electronics:"electronique",jewelry:"jewelery","women's clothing":"women's clothing","men's clothing":"men's clothing",jewelery:"jewelery"};return e[i]?e[i]:i}var ve=class t{ALL_SITE_CATEGORIES=["electronique","audio","gaming","photo","accessoires","men's clothing","women's clothing","jewelery","maison","beaute"];store=_(te);route=_(Z);products=[];categories=[];selectedCategory="";loading=!1;error=null;ngOnInit(){return N(this,null,function*(){this.loading=!0,this.error=null;try{let i=this.store.getAll(),e=yield fetch("https://fakestoreapi.com/products");if(!e.ok)throw new Error("FakeStore fetch failed");let s=(yield e.json()).map(Gt),d=[...i,...s];for(let I of d)I.category=it(I.category);this.categories=this.ALL_SITE_CATEGORIES,this.products=d,console.table([{where:"local",count:i.length},{where:"fakestore",count:s.length},{where:"merged",count:d.length}]),console.log("catsFromProducts:",this.categories)}catch(i){this.error=i;let e=this.store.getAll();this.products=e,this.categories=Ut(e),console.error(i)}finally{this.loading=!1}this.route.queryParamMap.subscribe(i=>{this.selectedCategory=qt(i.get("category"))}),window.scrollTo(0,0)})}reload(){this.ngOnInit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-catalog"]],decls:9,vars:5,consts:[[1,"min-h-screen","bg-[var(--bg-light,#f9fafb)]"],[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","mb-8"],["class","py-16 grid place-items-center text-gray-500",4,"ngIf"],["class","py-16 text-center",4,"ngIf"],[3,"products","categories","initialCategory"],[1,"py-16","grid","place-items-center","text-gray-500"],[1,"py-16","text-center"],[1,"text-2xl","font-bold","mb-2"],[1,"text-gray-600","mb-4"],[1,"px-6","py-2","rounded-lg","bg-blue-600","text-white","hover:bg-blue-700",3,"click"]],template:function(e,o){e&1&&(r(0,"div",0),p(1,"app-header"),r(2,"main",1)(3,"h1",2),a(4,"Catalogue de Produits"),n(),u(5,At,2,0,"div",3)(6,Bt,7,0,"div",4),p(7,"app-product-grid",5),n(),p(8,"app-footer"),n()),e&2&&(l(5),c("ngIf",o.loading),l(),c("ngIf",o.error&&!o.loading),l(),c("products",o.products)("categories",o.categories)("initialCategory",o.selectedCategory))},dependencies:[T,k,D,M,_e],encapsulation:2})};var le=se(ce());var be=class t{http=_(qe);base="https://fakestoreapi.com";getCategories(){return this.http.get(`${this.base}/products/categories`)}getAll(){return this.http.get(`${this.base}/products`)}getById(i){return this.http.get(`${this.base}/products/${i}`)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})};var rt=()=>[1,2,3,4,5],$t=t=>["/products",t];function zt(t,i){t&1&&(V(0),a(1,"Chargement\u2026"),R())}function Wt(t,i){t&1&&(V(0),a(1,"Produit introuvable"),R())}function Ht(t,i){t&1&&p(0,"span",46)}function Qt(t,i){if(t&1){let e=C();r(0,"button",43),g("click",function(){let s=x(e).index,d=m(2);return h(d.select(s))}),p(1,"img",44),u(2,Ht,1,0,"span",45),n()}if(t&2){let e=i.$implicit,o=i.index,s=m(2);w("ring-blue-600",s.isActive(o))("ring-transparent",!s.isActive(o)),De("aria-pressed",s.isActive(o)),l(),c("src",e,P)("alt","Aper\xE7u "+(o+1)),l(),c("ngIf",s.isActive(o))}}function Kt(t,i){t&1&&p(0,"i",47)}function Jt(t,i){t&1&&p(0,"i",48)}function Yt(t,i){if(t&1&&(V(0),a(1),R()),t&2){let e=m(2);l(),f("\u2014 ",e.stockCount," pi\xE8ces")}}function Zt(t,i){if(t&1&&(r(0,"span",49),a(1),n()),t&2){let e=i.$implicit,o=m(2);l(),f(" ",e<=o.rateRounded()?"\u2605":"\u2606"," ")}}function Xt(t,i){if(t&1&&(r(0,"div",54)(1,"dt",55),a(2),n(),r(3,"dd",56),a(4),n()()),t&2){let e=i.$implicit;l(2),y(e.label),l(2),y(e.value)}}function ei(t,i){if(t&1&&(r(0,"section",50)(1,"h3",28),a(2,"Caract\xE9ristiques techniques"),n(),r(3,"div",51)(4,"dl",52),u(5,Xt,5,2,"div",53),n()()()),t&2){let e=m(2);l(5),c("ngForOf",e.specs)("ngForTrackBy",e.trackByLabel)}}function ti(t,i){if(t&1&&(r(0,"span"),a(1),n()),t&2){let e=i.$implicit;l(),y(e?"\u2605":"\u2606")}}function ii(t,i){if(t&1&&(r(0,"article",59)(1,"div",60)(2,"div",61),a(3),n(),r(4,"div",62),a(5),v(6,"date"),n()(),r(7,"div",63),u(8,ti,2,1,"span",64),r(9,"span",65),a(10),v(11,"number"),n()(),r(12,"p",66),a(13),n()()),t&2){let e=i.$implicit,o=m(3);l(3),y(e.author),l(2),y(b(6,5,e.date,"medium")),l(3),c("ngForOf",o.starLine(e.rating)),l(2),f("(",b(11,8,e.rating,"1.1-1"),")"),l(3),y(e.comment)}}function ri(t,i){if(t&1&&(r(0,"div",57),u(1,ii,14,11,"article",58),n()),t&2){let e=m(2);l(),c("ngForOf",e.reviews)("ngForTrackBy",e.trackByReview)}}function ni(t,i){t&1&&(r(0,"div",67),a(1," Aucun avis pour le moment. Soyez le premier \xE0 donner votre avis ! "),n())}function oi(t,i){t&1&&(r(0,"small",68),a(1," Nom requis (min 2 caract\xE8res) "),n())}function ai(t,i){if(t&1){let e=C();r(0,"button",69),g("click",function(){let s=x(e).$implicit,d=m(2);return h(d.setRating(s))}),a(1," \u2605 "),n()}if(t&2){let e=i.$implicit,o=m(2);w("text-amber-500",e<=o.rating)("text-gray-300",e>o.rating)}}function li(t,i){t&1&&(r(0,"small",68),a(1," Note requise (1 \xE0 5) "),n())}function si(t,i){t&1&&(r(0,"small",68),a(1," Commentaire requis (min 5 caract\xE8res) "),n())}function ci(t,i){if(t&1&&(r(0,"span",70),a(1),n()),t&2){let e=m(2);l(),y(e.reviewMsg)}}function mi(t,i){if(t&1){let e=C();V(0),r(1,"div",5)(2,"div")(3,"div",6),p(4,"img",7),n(),r(5,"div",8),u(6,Qt,3,8,"button",9),n()(),r(7,"div")(8,"h1",10),a(9),n(),r(10,"div",11)(11,"span",12),u(12,Kt,1,0,"i",13)(13,Jt,1,0,"i",14),a(14),u(15,Yt,2,1,"ng-container",3),n()(),r(16,"div",15),u(17,Zt,2,1,"span",16),r(18,"span",17),a(19),v(20,"number"),n()(),r(21,"p",18),a(22),v(23,"number"),n(),r(24,"p",19),a(25),n(),r(26,"div",20)(27,"div",21)(28,"button",22),g("click",function(){x(e);let s=m();return h(s.decQty())}),a(29,"-"),n(),r(30,"span",23),a(31),n(),r(32,"button",22),g("click",function(){x(e);let s=m();return h(s.incQty())}),a(33,"+"),n()(),r(34,"button",24),g("click",function(){x(e);let s=m();return h(s.addToCart())}),a(35," Ajouter au panier "),n(),r(36,"button",25),g("click",function(){x(e);let s=m();return h(s.toggleFav())}),r(37,"span"),a(38,"\u2764"),n(),r(39,"span"),a(40),n()()(),u(41,ei,6,2,"section",26),r(42,"section",27)(43,"h3",28),a(44,"Avis clients"),n(),u(45,ri,2,2,"div",29)(46,ni,2,0,"ng-template",null,0,oe),r(48,"div",30)(49,"h4",31),a(50,"Laisser un avis"),n(),r(51,"form",32),g("ngSubmit",function(){x(e);let s=m();return h(s.submitReview())}),r(52,"div",33)(53,"div")(54,"label",34),a(55,"Votre nom"),n(),p(56,"input",35),u(57,oi,2,0,"small",36),n(),r(58,"div")(59,"label",34),a(60,"Note"),n(),r(61,"div",37),u(62,ai,2,4,"button",38),n(),u(63,li,2,0,"small",36),n()(),r(64,"div")(65,"label",34),a(66,"Commentaire"),n(),p(67,"textarea",39),u(68,si,2,0,"small",36),n(),r(69,"div",40)(70,"button",41),a(71),n(),u(72,ci,2,1,"span",42),n()()()()()(),R()}if(t&2){let e=ne(47),o=m();l(4),c("src",o.images[o.current]||o.product.image,P)("alt",o.product.title),l(2),c("ngForOf",o.images),l(3),y(o.product.title),l(2),c("ngClass",o.inStock?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),l(),c("ngIf",o.inStock),l(),c("ngIf",!o.inStock),l(),f(" ",o.inStock?"Disponible en stock":"Rupture de stock"," "),l(),c("ngIf",o.inStock),l(2),c("ngForOf",Q(37,rt)),l(2),f("(",b(20,31,o.rateRaw(),"1.1-1"),")"),l(3),f(" ",b(23,34,o.product.price,"1.2-2")," DT "),l(3),y(o.product.description),l(6),y(o.qty),l(3),c("disabled",!o.inStock),l(2),w("border-rose-300",o.isFav),l(),w("text-rose-600",o.isFav),l(3),y(o.isFav?"Dans vos favoris":"Ajouter aux favoris"),l(),c("ngIf",o.specs==null?null:o.specs.length),l(4),c("ngIf",o.reviews==null?null:o.reviews.length)("ngIfElse",e),l(6),c("formGroup",o.reviewForm),l(6),c("ngIf",o.rf.author.touched&&o.rf.author.invalid),l(5),c("ngForOf",Q(38,rt)),l(),c("ngIf",o.rf.rating.touched&&o.rf.rating.invalid),l(5),c("ngIf",o.rf.comment.touched&&o.rf.comment.invalid),l(2),c("disabled",o.reviewForm.invalid||o.submittingReview),l(),f(" ",o.submittingReview?"Envoi\u2026":"Publier l\u2019avis"," "),l(),c("ngIf",o.reviewMsg)}}function di(t,i){if(t&1&&(r(0,"a",75),p(1,"img",76),r(2,"div",77)(3,"h3",78),a(4),n(),r(5,"div",79),a(6),v(7,"number"),n()()()),t&2){let e=i.$implicit;c("routerLink",L(8,$t,e.id)),l(),c("src",e.image,P)("alt",e.title),l(3),y(e.title),l(2),f("",b(7,5,e.price,"1.2-2")," DT")}}function pi(t,i){if(t&1&&(r(0,"section",71)(1,"h2",72),a(2,"Produits similaires"),n(),r(3,"div",73),u(4,di,8,10,"a",74),n()()),t&2){let e=m();l(4),c("ngForOf",e.similar)}}var ye=class t{router=_(j);route=_(Z);store=_(te);cart=_($);fake=_(be);fb=_(ue);auth=_(U);product;similar=[];images=[];current=0;loading=!1;error=null;inStock=!1;stockCount=0;specs=[];reviews=[];qty=1;wishlist=_(Ye);isFav=!1;submittingReview=!1;reviewMsg="";reviewForm=this.fb.group({author:["",[S.required,S.minLength(2)]],rating:[0,[S.required,S.min(1),S.max(5)]],comment:["",[S.required,S.minLength(5)]]});get rf(){return this.reviewForm.controls}ngOnInit(){this.route.paramMap.subscribe(i=>{let e=i.get("id");if(!e){this.error=!0;return}this.loadKey(e),window.scrollTo({top:0,behavior:"smooth"})})}exactCatSlug(i){return(i??"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}buildSimilarStrict(i,e,o=8){let s=e.id,d=this.exactCatSlug(e.category);return i.filter(I=>I&&I.id!==s&&this.exactCatSlug(I.category)===d).sort((I,Y)=>(Y.rating??0)-(I.rating??0)).slice(0,o)}normalizeCat(i){let e=(i||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"");return/(electronique|informatique|audio|gaming|accessoires|photo|electronics)/.test(e)?"tech":/(maison|home|appliance)/.test(e)?"home":/(beaute|beauty|cosmetic)/.test(e)?"beauty":/(jewel|bijou|jewellery|jewelery)/.test(e)?"jewelry":/(men|women|vetement|clothing|apparel)/.test(e)?"fashion":"other"}loadKey(i){this.loading=!0,this.error=null,this.store.getOneByKey$(i).pipe(re(1)).subscribe({next:e=>{this.setProductData(e),this.store.getAllMerged$().pipe(re(1)).subscribe(o=>{this.similar=this.buildSimilarStrict(o,e)}),this.loading=!1},error:()=>{this.error=!0,this.loading=!1}})}load(i){this.loading=!0,this.error=null,this.store.getOne$(i).pipe(re(1)).subscribe({next:e=>{if(!e){this.error=!0,this.loading=!1;return}this.setProductData(e),this.store.getAllMerged$().pipe(re(1)).subscribe(o=>{this.similar=this.buildSimilarStrict(o,e)}),this.loading=!1},error:e=>{this.error=e,this.loading=!1}})}setProductData(i){this.product=i;let e=(i.images??[]).filter(Boolean);for(;e.length<3;)e.push(i.image);this.images=e.slice(0,3),this.stockCount=i.stock??10,this.inStock=this.stockCount>0,this.specs=i.specs??[];let o=i.reviews??[],s=this.loadLocalReviews(i.id);this.reviews=[...s,...o];let d=this.auth.currentUser();d&&!this.reviewForm.value.author&&this.reviewForm.patchValue({author:`${d.firstName} ${d.lastName}`.trim()}),this.isFav=this.wishlist.isFavorite(Number(i.id))}toggleFav(){if(!this.product)return;if(!this.auth.currentUser()){le.default.fire({title:"Connexion requise",text:"Veuillez vous connecter pour ajouter des produits \xE0 vos favoris \u{1F499}",icon:"info",showCancelButton:!0,confirmButtonText:"Se connecter",cancelButtonText:"Annuler",confirmButtonColor:"#2563eb",cancelButtonColor:"#6b7280"}).then(e=>{e.isConfirmed&&this.router.navigate(["/auth/signin"])});return}this.wishlist.toggle({id:Number(this.product.id),title:this.product.title,price:this.product.price,image:this.images[this.current]??this.product.image}),this.isFav=this.wishlist.isFavorite(Number(this.product.id)),le.default.fire({toast:!0,position:"top-end",timer:1200,showConfirmButton:!1,icon:this.isFav?"success":"info",title:this.isFav?"Ajout\xE9 aux favoris \u2764":"Retir\xE9 des favoris"})}rateRounded(){return Math.floor(this.product?.rating??0)}rateRaw(){return this.product?.rating??0}decQty(){this.qty=Math.max(1,this.qty-1)}incQty(){this.qty=Math.min(99,this.qty+1)}addToCart(){this.product&&(this.cart.addToCart({id:this.product.id,name:this.product.title,price:this.product.price,image:this.images[this.current]??this.product.image,quantity:this.qty}),le.default.fire({toast:!0,position:"top-end",icon:"success",title:"Ajout\xE9 au panier \u{1F6D2}",timer:1500,showConfirmButton:!1}))}select(i){this.current=i}isActive(i){return this.current===i}trackByLabel=(i,e)=>e.label;trackByReview=(i,e)=>e.author+e.date;starLine(i){return Array.from({length:5},(e,o)=>o<Math.floor(i))}lsKeyForReviews(i){return`app.reviews.${i}`}loadLocalReviews(i){try{return JSON.parse(localStorage.getItem(this.lsKeyForReviews(i))||"[]")}catch{return[]}}saveLocalReviews(i,e){localStorage.setItem(this.lsKeyForReviews(i),JSON.stringify(e))}setRating(i){this.reviewForm.patchValue({rating:i})}submitReview(){return N(this,null,function*(){if(!this.product)return;if(this.reviewForm.invalid){this.reviewForm.markAllAsTouched();return}let i=this.reviewForm.getRawValue(),e={author:i.author.trim(),rating:Math.max(1,Math.min(5,Number(i.rating))),comment:(i.comment||"").trim(),date:new Date().toISOString()};this.submittingReview=!0;try{let o=this.loadLocalReviews(this.product.id),s=[e,...o];this.saveLocalReviews(this.product.id,s);let d=this.product.reviews??[];this.reviews=[...s,...d],this.reviewForm.patchValue({rating:0,comment:""}),this.reviewMsg="Merci pour votre avis !",yield le.default.fire({toast:!0,position:"top-end",icon:"success",title:"Avis publi\xE9 \u2705",timer:1600,showConfirmButton:!1}),setTimeout(()=>this.reviewMsg="",2e3)}finally{this.submittingReview=!1}})}get rating(){return Number(this.reviewForm.get("rating")?.value??0)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-product-detail"]],decls:8,vars:4,consts:[["noReviews",""],[1,"min-h-screen","bg-[var(--bg-light,#f9fafb)]"],[1,"container","mx-auto","px-4","py-8"],[4,"ngIf"],["class","mt-12",4,"ngIf"],[1,"grid","md:grid-cols-2","gap-8","mb-12"],[1,"flex","items-center","justify-center"],[1,"w-64","h-64","md:w-80","md:h-80","lg:w-96","lg:h-96","object-contain","rounded-xl","shadow-sm","transition-transform","duration-300","hover:scale-105",3,"src","alt"],[1,"mt-4","grid","grid-cols-3","gap-3"],["type","button","class","relative rounded-lg overflow-hidden ring-2 transition hover:ring-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-400",3,"ring-blue-600","ring-transparent","click",4,"ngFor","ngForOf"],[1,"text-3xl","font-bold","mb-3"],[1,"mb-4"],[1,"inline-flex","items-center","gap-2","px-3","py-1","rounded-full","text-sm",3,"ngClass"],["class","icon-check-circle",4,"ngIf"],["class","icon-x-circle",4,"ngIf"],[1,"flex","items-center","mb-4","text-[#f59e0b]"],["class","select-none",4,"ngFor","ngForOf"],[1,"ml-2","text-gray-600"],[1,"text-4xl","font-bold","text-blue-600","mb-3"],[1,"text-gray-700","mb-6"],[1,"flex","gap-4","mb-6"],[1,"flex","items-center","border","rounded-lg"],[1,"px-4","py-2",3,"click"],[1,"px-4","py-2"],[1,"px-6","py-3","rounded-lg","bg-blue-600","text-white","hover:bg-blue-700","flex-1","disabled:opacity-60",3,"click","disabled"],["type","button",1,"px-4","py-3","rounded-lg","border","hover:bg-rose-50","flex","items-center","gap-2",3,"click"],["class","mt-6",4,"ngIf"],[1,"mt-10"],[1,"text-xl","font-semibold","mb-3"],["class","space-y-4",4,"ngIf","ngIfElse"],[1,"mt-8","rounded-2xl","border","bg-white","p-4","sm:p-6"],[1,"text-lg","font-semibold","mb-3"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","sm:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","mb-1"],["formControlName","author","placeholder","ex: Ali",1,"w-full","border","rounded-lg","px-3","py-2"],["class","text-red-600",4,"ngIf"],[1,"flex","items-center","gap-2"],["type","button","class","text-2xl transition","aria-label","noter",3,"text-amber-500","text-gray-300","click",4,"ngFor","ngForOf"],["rows","4","formControlName","comment","placeholder","Partagez votre exp\xE9rience...",1,"w-full","border","rounded-lg","px-3","py-2"],[1,"flex","items-center","gap-3"],[1,"px-5","py-2","rounded-lg","bg-blue-600","text-white","hover:bg-blue-700","disabled:opacity-60",3,"disabled"],["class","text-sm text-green-700",4,"ngIf"],["type","button",1,"relative","rounded-lg","overflow-hidden","ring-2","transition","hover:ring-blue-300","focus:outline-none","focus:ring-2","focus:ring-blue-400",3,"click"],[1,"w-24","h-30","object-cover","mx-auto","rounded-lg",3,"src","alt"],["class","pointer-events-none absolute inset-0 ring-2 ring-blue-600 rounded-lg",4,"ngIf"],[1,"pointer-events-none","absolute","inset-0","ring-2","ring-blue-600","rounded-lg"],[1,"icon-check-circle"],[1,"icon-x-circle"],[1,"select-none"],[1,"mt-6"],[1,"overflow-hidden","rounded-xl","border","bg-white"],[1,"divide-y"],["class","grid grid-cols-3 gap-4 p-3 sm:p-4",4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","grid-cols-3","gap-4","p-3","sm:p-4"],[1,"col-span-1","text-gray-500"],[1,"col-span-2","font-medium","text-gray-900"],[1,"space-y-4"],["class","rounded-xl border bg-white p-4",4,"ngFor","ngForOf","ngForTrackBy"],[1,"rounded-xl","border","bg-white","p-4"],[1,"flex","items-center","justify-between"],[1,"font-semibold"],[1,"text-xs","text-gray-500"],[1,"text-amber-500","my-1"],[4,"ngFor","ngForOf"],[1,"text-gray-500","text-xs","ml-1"],[1,"text-gray-700","whitespace-pre-line"],[1,"p-6","rounded-xl","border","bg-white","text-gray-600"],[1,"text-red-600"],["type","button","aria-label","noter",1,"text-2xl","transition",3,"click"],[1,"text-sm","text-green-700"],[1,"mt-12"],[1,"text-2xl","font-bold","mb-6"],[1,"grid","grid-cols-2","sm:grid-cols-3","lg:grid-cols-4","gap-6"],["class","group block rounded-xl border border-gray-200 bg-white overflow-hidden hover:shadow-md transition",3,"routerLink",4,"ngFor","ngForOf"],[1,"group","block","rounded-xl","border","border-gray-200","bg-white","overflow-hidden","hover:shadow-md","transition",3,"routerLink"],[1,"h-56","w-39","object-cover","mx-auto","rounded-lg","group-hover:scale-105","transition-transform","duration-300",3,"src","alt"],[1,"p-3"],[1,"text-sm","font-semibold","line-clamp-2"],[1,"mt-2","text-blue-600","font-bold"]],template:function(e,o){e&1&&(r(0,"div",1),p(1,"app-header"),r(2,"main",2),u(3,zt,2,0,"ng-container",3)(4,Wt,2,0,"ng-container",3)(5,mi,73,39,"ng-container",3)(6,pi,5,1,"section",4),n(),p(7,"app-footer"),n()),e&2&&(l(3),c("ngIf",o.loading),l(),c("ngIf",o.error&&!o.loading),l(),c("ngIf",o.product&&!o.loading),l(),c("ngIf",o.similar.length))},dependencies:[T,Ae,F,k,D,M,G,fe,ee,z,W,X,de,pe,q,Be],encapsulation:2})};var nt=()=>{let t=_(U),i=_(j);return t.isLoggedIn()?!0:(i.navigateByUrl("/auth/signin"),!1)};var ui=()=>["/catalog"],gi=t=>({category:t}),fi=t=>["/products",t];function xi(t,i){if(t&1&&(V(0),a(1," R\xE9sultats pour \xAB "),r(2,"b"),a(3),n(),a(4),R()),t&2){let e=m();l(3),y(e.q),l(),Ne(" \xBB \u2014 ",e.products.length," produit(s), ",e.categories.length," cat\xE9gorie(s) ")}}function hi(t,i){t&1&&a(0," Tapez un mot-cl\xE9 pour rechercher dans tout le site. ")}function _i(t,i){t&1&&(r(0,"div",9)(1,"div",10),a(2,"\u{1F50E}"),n(),r(3,"p",11),a(4,"Recherchez des produits, des cat\xE9gories\u2026"),n(),r(5,"p",12),a(6,"Exemples : \xAB iphone \xBB, \xAB casque \xBB, \xAB gaming \xBB\u2026"),n()())}function vi(t,i){if(t&1&&(r(0,"a",18),a(1),n()),t&2){let e=i.$implicit;c("routerLink",Q(3,ui))("queryParams",L(4,gi,e)),l(),f(" #",e," ")}}function bi(t,i){if(t&1&&(r(0,"div",3)(1,"h2",15),a(2,"Cat\xE9gories"),n(),r(3,"div",16),u(4,vi,2,6,"a",17),n()()),t&2){let e=m(2);l(4),c("ngForOf",e.categories)}}function yi(t,i){if(t&1&&(r(0,"a",21),p(1,"img",22),r(2,"div",23),a(3),n(),r(4,"div",24),a(5),n(),r(6,"div",25),a(7),v(8,"currency"),n()()),t&2){let e=i.$implicit;c("routerLink",L(9,fi,e.id)),l(),c("src",e.image,P)("alt",e.title),l(2),y(e.title),l(2),y(e.category),l(2),y(b(8,6,e.price,"EUR"))}}function Si(t,i){if(t&1&&(r(0,"div",19),u(1,yi,9,11,"a",20),n()),t&2){let e=m(2);l(),c("ngForOf",e.products)}}function Ci(t,i){if(t&1&&(r(0,"div",9)(1,"div",10),a(2,"\u{1F648}"),n(),r(3,"p",11),a(4),n(),r(5,"p",12),a(6,"Astuce : essayez un autre terme ou une cat\xE9gorie plus large."),n()()),t&2){let e=m(2);l(4),f("Aucun r\xE9sultat trouv\xE9 pour \xAB ",e.q," \xBB.")}}function wi(t,i){if(t&1&&(V(0),u(1,bi,5,1,"div",13)(2,Si,2,1,"div",14)(3,Ci,7,1,"ng-template",null,1,oe),R()),t&2){let e=ne(4),o=m();l(),c("ngIf",o.categories.length),l(),c("ngIf",o.products.length)("ngIfElse",e)}}var Se=class t{route=_(Z);store=_(te);q="";products=[];categories=[];allProducts=[];ngOnInit(){this.allProducts=this.store.getAll?.()??[],this.route.queryParamMap.subscribe(i=>{this.q=(i.get("q")||"").trim().toLowerCase(),this.applySearch()})}applySearch(){if(!this.q){this.products=[],this.categories=[];return}let i=this.q;this.products=this.allProducts.filter(o=>(o.title||"").toLowerCase().includes(i)||(o.description||"").toLowerCase().includes(i)||(o.category||"").toLowerCase().includes(i));let e=new Set(this.allProducts.map(o=>(o.category||"").toLowerCase()).filter(Boolean));this.categories=Array.from(e).filter(o=>o.includes(i))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-search-results"]],decls:12,vars:4,consts:[["noQuery",""],["noResults",""],[1,"mx-auto","max-w-7xl","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6"],[1,"text-2xl","md:text-3xl","font-bold"],[1,"text-sm","text-gray-600"],[4,"ngIf","ngIfElse"],["class","p-10 text-center rounded-xl border bg-white",4,"ngIf"],[4,"ngIf"],[1,"p-10","text-center","rounded-xl","border","bg-white"],[1,"text-5xl","mb-2"],[1,"font-medium"],[1,"text-gray-500"],["class","mb-6",4,"ngIf"],["class","grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",4,"ngIf","ngIfElse"],[1,"text-lg","font-semibold","mb-3"],[1,"flex","flex-wrap","gap-2"],["class","px-3 py-1.5 rounded-full border bg-white hover:bg-blue-50 transition text-sm",3,"routerLink","queryParams",4,"ngFor","ngForOf"],[1,"px-3","py-1.5","rounded-full","border","bg-white","hover:bg-blue-50","transition","text-sm",3,"routerLink","queryParams"],[1,"grid","gap-6","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4"],["class","block bg-white rounded-xl border p-4 hover:shadow-md transition",3,"routerLink",4,"ngFor","ngForOf"],[1,"block","bg-white","rounded-xl","border","p-4","hover:shadow-md","transition",3,"routerLink"],[1,"w-full","h-44","object-cover","rounded-lg","mb-3",3,"src","alt"],[1,"font-semibold","line-clamp-2"],[1,"text-sm","text-gray-500","capitalize"],[1,"mt-2","font-bold"]],template:function(e,o){if(e&1&&(p(0,"app-header"),r(1,"section",2)(2,"header",3)(3,"h1",4),a(4,"Recherche"),n(),r(5,"p",5),u(6,xi,5,3,"ng-container",6)(7,hi,1,0,"ng-template",null,0,oe),n()(),u(9,_i,7,0,"div",7)(10,wi,5,3,"ng-container",8),n(),p(11,"app-footer")),e&2){let s=ne(8);l(6),c("ngIf",o.q)("ngIfElse",s),l(3),c("ngIf",!o.q),l(),c("ngIf",o.q)}},dependencies:[T,F,k,G,D,M,Oe],encapsulation:2})};var ot=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",loadChildren:()=>import("./chunk-T25KUFP6.js").then(t=>t.HomeModule)},{path:"auth",loadChildren:()=>import("./chunk-KXJ2ZAGS.js").then(t=>t.AuthModule)},{path:"cart",component:xe},{path:"checkout",component:he},{path:"catalog",component:ve},{path:"products/:id",component:ye},{path:"account",canActivate:[nt],loadComponent:()=>import("./chunk-BZSAMJTD.js").then(t=>t.AccountLayout),children:[{path:"",pathMatch:"full",redirectTo:"profile"},{path:"profile",loadComponent:()=>import("./chunk-JOEYODJZ.js").then(t=>t.Profile)},{path:"orders",loadComponent:()=>import("./chunk-C3HD2TTB.js").then(t=>t.AccountOrders)},{path:"wishlist",loadComponent:()=>import("./chunk-6NGQ75QO.js").then(t=>t.AccountWishlist)},{path:"addresses",loadComponent:()=>import("./chunk-3AFIZCDL.js").then(t=>t.AccountAddresses)}]},{path:"search",component:Se},{path:"order/success",loadComponent:()=>import("./chunk-5WAZMFSG.js").then(t=>t.OrderSuccess)},{path:"promotions",loadComponent:()=>import("./chunk-3W5BZFBI.js").then(t=>t.PromotionsPage)}];var at={providers:[Pe(),Re({eventCoalescing:!0}),Ue(ot),je()]};var Ce=class t{title=ke("ecommerce-app");static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,o){e&1&&p(0,"router-outlet")},dependencies:[Ge],encapsulation:2})};Le(Ce,at).catch(t=>console.error(t));
